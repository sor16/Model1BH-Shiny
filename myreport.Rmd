---
title: "Bayesian Rating Curve"
mathjax: "http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
---
```{r setup, include=FALSE}
Sys.setlocale("LC_ALL","is_IS")
```

```{r echo=FALSE, include=FALSE}
library(stargazer,quietly=TRUE)
```  
   
      
```{r echo=FALSE}
plotlist=model1fast()
a=exp(plotlist$mu[1])
b=plotlist$mu[2]
c_hat=min(plotlist$RC$w)-exp(plotlist$t_m[1,])
varappr=mean(plotlist$varappr)
predict=1.96*sqrt(varappr)
```

Formula for rating curve: $$\ Q(W) = `r a` \cdot (W - `r c_hat` )^{ `r b`}$$
    
Formula for upper predictive: $$\ Q_{upper}(W) = `r a` \cdot (W - `r c_hat` )^{ `r b`} \cdot `r exp(predict)`$$

Formula for lower predictive: $$\ Q_{lower}(W) = `r a` \cdot (W - `r c_hat` )^{ `r b`} \cdot `r exp(-predict)`$$

```{r results='asis',echo=FALSE}
stargazer(plotratingcurve()$tafla,type="latex",summary=FALSE, title=input$name,header=FALSE,digits=3,digits.extra=3)
```

```{r,echo=FALSE}
if(length(plotratingcurve())!=0)
    if(class(plotratingcurve()[[1]])[1]=="gg")
        plotratingcurve()[[1]]
```
   
   
```{r,echo=FALSE}
if(length(plotratingcurve())>=2)
    if(class(plotratingcurve()[[2]])[1]=="gg")
        plotratingcurve()[[2]]
```
   
   
```{r,echo=FALSE}
if(length(plotratingcurve())>=3)
    if(class(plotratingcurve()[[3]])[1]=="gg")
        plotratingcurve()[[3]]
```
   
   
```{r,echo=FALSE}
if(length(plotratingcurve())>=4)
    if(class(plotratingcurve()[[4]])[1]=="gg")
        plotratingcurve()[[4]]
```

